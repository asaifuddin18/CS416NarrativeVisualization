<!DOCTYPE html>
<html>
    <head>
        <style>
            .button {
            background-color: #e7e7e7;
            border: none;
            color: black;
            padding: 10px 10px;
            text-align: center;
            text-decoration: none;
            display: inline-block;
            font-size: 10px;
            transition-duration: .5s;
            width: 100px;
        }
        /*https://stackoverflow.com/questions/52050828/show-tooltip-on-the-d3-map*/
        div.tooltip {   
    position: absolute;         
    text-align: center;                      
    font: 12px sans-serif;      
    background: lightsteelblue; 
    border: 0px;        
    border-radius: 8px;         
    pointer-events: none;           
}
        .button:hover {
            background-color: #000000;
            color: white;
        }
        .center_div {
            display: flex;
            justify-content: center;
        }
        </style>
    </head>
    <body>
      <div class="center_div">
        <button class="button" onclick = "window.location.href='index.html'">First Page</button>
        <button class="button" onclick = "window.location.href='linegraph.html'">Second Page</button>
        <button class="button" onclick = "window.location.href='gdp_growth.html'">US GDP Growth</button>
        <button class="button" onclick = "window.location.href='china_gdp.html'">China GDP Growth</button>
        <button class="button" onclick = "window.location.href='eu_gdp.html'">EU GDP Growth</button>
        <button class="button" onclick = "window.location.href='japan_gdp.html'">Japan GDP Growth</button>
    </div>
        <div id="graph_div" class="center_div">
        </div>
    </body>
    <script src="https://d3js.org/d3.v4.js"></script>
    <script src="https://rawgit.com/susielu/d3-annotation/master/d3-annotation.min.js"></script>
    <script>

        // set the dimensions and margins of the graph
        const margin = {top: 10, right: 200, bottom: 30, left: 100},
            width = 1300 - margin.left - margin.right,
            height = 800 - margin.top - margin.bottom;
        
        // append the svg object to the body of the page
var svg = d3.select("#graph_div")
  .append("svg")
    .attr("width", width + margin.left + margin.right)
    .attr("height", height + margin.top + margin.bottom)
    .call(d3.zoom().on("zoom", function () {
       svg.attr("transform", d3.event.transform)
    }))

  .append("g")
    .attr("transform",
          "translate(" + margin.left + "," + margin.top + ")");

//Read the data
d3.csv("https://raw.githubusercontent.com/asaifuddin18/asaifuddin18.github.io/main/data.csv", function(data) {

  // group the data: I want to draw one line per group
  var sumstat = d3.nest() // nest function allows to group the calculation per level of a factor
    .key(function(d) { return d.country;})
    .entries(data);

  // Add X axis --> it is a date format
  var x = d3.scaleLinear()
    .domain(d3.extent(data, function(d) { return d.year; }))
    .range([ 0, width ]);
  svg.append("g")
    .attr("transform", "translate(0," + height + ")")
    .call(d3.axisBottom(x).ticks(5));

  // Add Y axis
  var y = d3.scaleLinear()
    .domain([0, d3.max(data, function(d) { return +d.gdp; })])
    .range([ height, 0 ]);
  svg.append("g")
    .call(d3.axisLeft(y));

  // color palette
  var res = sumstat.map(function(d){ return d.key }) // list of group names
  var colors = ["#000000", "#006400", "#ff0000", "#ffd700", "#00ff00", "#4169e1", "#e9967a", "#00ffff", "#0000ff", "#ff1493"]
  var color = d3.scaleOrdinal()
    .domain(res)
    .range(colors)


  

  
  // Draw the line
  svg.selectAll(".line")
      .data(sumstat)
      .enter()
      .append("path")
        .attr("fill", "none")
        .attr("stroke", function(d){ return color(d.key) })
        .attr("stroke-width", 1.5)
        .attr("d", function(d){
          return d3.line()
            .x(function(d) { return x(d.year); })
            .y(function(d) { return y(+d.gdp); })
            (d.values)
        })

    

})
        var legend_x = 1050
        var legend_text = legend_x + 20
        var colors = ["#000000", "#006400", "#ff0000", "#ffd700", "#00ff00", "#4169e1", "#e9967a", "#00ffff", "#0000ff", "#ff1493"]
        var countries = ["United States", "China", "European Union", "Japan", "India", "Brazil", "Canada", "Russia", "South Korea", "Australia"]
        var c0 = colors[0]
        svg.append("circle").attr("cx",legend_x).attr("cy",130).attr("r", 6).style("fill", colors[9]) //7 us
        svg.append("text").attr("x", legend_text).attr("y", 130).text(countries[0]).style("font-size", "15px").attr("alignment-baseline","middle")
        svg.append("circle").attr("cx",legend_x).attr("cy",160).attr("r", 6).style("fill", colors[3]) //3 china
        svg.append("text").attr("x", legend_text).attr("y", 160).text(countries[1]).style("font-size", "15px").attr("alignment-baseline","middle")
        svg.append("circle").attr("cx",legend_x).attr("cy",190).attr("r", 6).style("fill", colors[4]) //4 eu
        svg.append("text").attr("x", legend_text).attr("y", 190).text(countries[2]).style("font-size", "15px").attr("alignment-baseline","middle")
        svg.append("circle").attr("cx",legend_x).attr("cy",220).attr("r", 6).style("fill", colors[6]) //6 japan
        svg.append("text").attr("x", legend_text).attr("y", 220).text(countries[3]).style("font-size", "15px").attr("alignment-baseline","middle")
        svg.append("circle").attr("cx",legend_x).attr("cy",250).attr("r", 6).style("fill", colors[5]) //5 india
        svg.append("text").attr("x", legend_text).attr("y", 250).text(countries[4]).style("font-size", "15px").attr("alignment-baseline","middle")
        svg.append("circle").attr("cx",legend_x).attr("cy",280).attr("r", 6).style("fill", colors[2]) //2 brazil
        svg.append("text").attr("x", legend_text).attr("y", 280).text(countries[5]).style("font-size", "15px").attr("alignment-baseline","middle")
        svg.append("circle").attr("cx",legend_x).attr("cy",310).attr("r", 6).style("fill", colors[7]) //3 canada
        svg.append("text").attr("x", legend_text).attr("y", 310).text(countries[6]).style("font-size", "15px").attr("alignment-baseline","middle")
        svg.append("circle").attr("cx",legend_x).attr("cy",340).attr("r", 6).style("fill", colors[8]) //9 russia
        svg.append("text").attr("x", legend_text).attr("y", 340).text(countries[7]).style("font-size", "15px").attr("alignment-baseline","middle") //7,8
        svg.append("circle").attr("cx",legend_x).attr("cy",370).attr("r", 6).style("fill", colors[1]) //8 korea
        svg.append("text").attr("x", legend_text).attr("y", 370).text(countries[8]).style("font-size", "15px").attr("alignment-baseline","middle")
        svg.append("circle").attr("cx",legend_x).attr("cy",400).attr("r", 6).style("fill", colors[0]) //1 australia
        svg.append("text").attr("x", legend_text).attr("y", 400).text(countries[9]).style("font-size", "15px").attr("alignment-baseline","middle")

        const annotations = [
  {
    note: {
      label: "EU started to stagnate and fluctuate around 2008",
      title: "European Union",
      align: "right"
    },
    x: 785,
    y: 220,
    dy: -50,
    dx: -50
  },
  {
    note: {
      label: "China started to massively increase in GDP in the mid 90's",
      title: "China",
      align: "left"
    },
    x: 590,
    y: 730,
    dy: -20,
    dx: -20
  },
  {
    note: {
      label: "Japan stagnated around the mid 90's due to its limited resources",
      title: "Japan",
      align: "right"
    },
    x: 575,
    y: 577,
    dy: -100,
    dx: -100
  }
]
const makeAnnotations = d3.annotation()
  .annotations(annotations)
svg.append("g")
  .call(makeAnnotations)
        </script>
</html>
